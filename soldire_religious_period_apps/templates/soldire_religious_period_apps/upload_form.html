{% extends 'shared/_PanelMain.html' %}
{% load static %}
{% block main %}
    <div class="container">
        <h2 class="text-center">آپلود فایل اکسل دوره عقیدتی</h2>

        <!-- دکمه دانلود فایل نمونه -->
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-6">
                <button type="button" class="btn btn-info" onclick="downloadSampleExcel()">
                    دانلود فایل نمونه اکسل
                </button>
            </div>
        </div>

        <!-- فرم آپلود -->
        <form method="post" enctype="multipart/form-data" class="form-horizontal" style="margin-top: 30px;">
            {% csrf_token %}
            <div class="form-group">
                <label class="col-sm-2 control-label">فایل اکسل</label>
                <div class="col-sm-6">
                    {{ form.file }}
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-6">
                    <button type="submit" class="btn btn-success">آپلود و ثبت</button>
                </div>
            </div>
        </form>
    </div>
{% endblock %}


{% block footer %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        function downloadSampleExcel() {
            var wb = XLSX.utils.book_new();
            var ws_data = [
                ["کدملی", "شماره دوره"],
                ["1234567890", 1],
                ["9876543210", 2]
            ];
            var ws = XLSX.utils.aoa_to_sheet(ws_data);
            XLSX.utils.book_append_sheet(wb, ws, "نمونه");

            XLSX.writeFile(wb, "sample.xlsx");
        }
    </script>
{% endblock %}