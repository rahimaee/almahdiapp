{% load render_partial %}
{% load static %}
{% load jalali_filters %}
{% load req %}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Ù†Ø§Ù…Ù‡ {% endblock %}</title>
    {% render_partial 'header_references_partial_view' %}
    <link href="{% static 'dist/css/fonts.css' %}" rel="stylesheet" />

  <style>
        @font-face {
            font-family: 'B Nazanin';
            src: local('B Nazanin Bold'),
            local('BNazanin-Bold'),
            url('/static/dist/fonts/BNaznnBd.woff2') format('woff2'),
            url('/static/dist/fonts/BNaznnBd.woff') format('woff'),
            url('/static/dist/fonts/BNaznnBd.ttf') format('truetype');
            font-weight: 700;
            font-stretch: normal;
        }
        @font-face {
            font-family: 'IranNastaliq';
            src: url('/static/dist/fonts/IranNastaliq.eot');
            src: url('/static/dist/fonts/IranNastaliq.eot?#iefix') format('embedded-opentype'),
                 url('/static/dist/fonts/IranNastaliq.woff2') format('woff2'),
                 url('/static/dist/fonts/IranNastaliq.woff') format('woff'),
                 url('/static/dist/fonts/IranNastaliq.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: Vazir;
            src: url('/static/dist/fonts/Vazir-FD-WOL.eot');
            src: local('YekanBakh-Regular'),
                url('/static/dist/fonts/Vazir-FD-WOL.eot?#iefix') format('embedded-opentype'),
                url('/static/dist/fonts/Vazir-FD-WOL.woff2') format('woff2'),
                url('/static/dist/fonts/Vazir-FD-WOL.woff') format('woff'),
                url('/static/dist/fonts/Vazir-FD-WOL.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
        @font-face {
            font-family: 'B Koodak';
            src: url('/static/dist/fonts/B Koodak Bold_0.ttf');
            src: local('B Koodak'), url('/static/dist/fonts/B Koodak Bold_0.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
        @font-face {
            font-family: 'B Titr';
            src: url('/static/dist/fonts/B Titr.ttf');
            src: local('B Titr'),
                    url('/static/dist/fonts/B Titr.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }


        html  .f-bnazanin *, body  .f-bnazanin * {
            font-family: 'B Nazanin';
        }
        html   .f-bkoodak *, body .f-bkoodak *,html  * .f-bkoodak , body * .f-bkoodak  {
            font-family: 'B Koodak';
        }
        html  .f-btitr * , body  .f-btitr *, html * .f-btitr  , body * .f-btitr {
            font-family: 'B Titr';
        }
        html  .f-irnasq * , body  .f-irnasq *, html * .f-irnasq  , body * .f-irnasq {
            font-family: 'IranNastaliq';
        }
        strong.f-btitr {
          font-size: 14px;
        }
    @media print {
      @page {
        size: A5 portrait;
        margin: 0;
      }
      html, body {
    margin: 0;
    padding: 0;
    height: auto;
    overflow: visible !important;
      }
      
      body {
        display: block !important;
        position: static !important;
      }
      * {
        visibility: hidden;
      }
    .pages .page {
      margin : 0;
                  font-family: 'B Nazanin';
    }
    .print-content {
      border: 0 none;
    }

       .pages *, 
       .pages .page,
       .pages .page * 
       {
        visibility: visible;
      }
      
      .pages {
        height: auto !important;
        overflow: visible !important;
        position: static !important;

      }
      .control,
      .no-print {
        display: none !important;
      }

    }
    


    .print-content {
      width: 148mm;
      height: 210mm;
      background: white;
      padding: 8mm 9mm;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      border : 1px solid #cacaca !important;
   }

    .pages .page {
      margin : 0 0 5px 0;
    }

     .content {
        font-size: 17px;
        line-height:1.8;
        text-align: justify;
        margin-top: 5px;
         height: auto;
         padding: 0px 10px;
      }
     .letter-content {
         min-height: auto;
     }
     .letter-content strong {
         font-weight: 500;
     }
      .flex-content {
         min-height:auto;
      }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 2px solid #666 !important;
      padding: 10px;

    }

    .header img {
      height: 50px;
    }

    .left-info {
        font-size: 11px;
        flex:1;
        display: flex;
        justify-content: end;
        text-align: right;
    }
    .left-info .letter-detail {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .sepah-logo {
        flex:1;
    }
    .slogan {
      text-align: center;
      font-weight: bold;
      margin: 0 auto;
      font-size: 10px;
      background: #fafafa;
      padding: 5px;
      border-top:0 none;
      width:max-content;
    }

    .content-box {
      border: 2px solid #666 !important;
      padding: 5px;
      display: flex;
      flex-direction: column;
      margin:5px 0;
        flex: 1;
    }

    .footer {
      display: flex;
      justify-content: end;
      padding: 0 20px;
      margin-top: 50px;      
    }

    .signature {
      text-align: center;
        position: relative;
    }

    .signature-box {
        border-radius:4px;
        border:1px dashed #aaa;
        background-color: #fafafa !important;
        margin:0 auto 10px;
    }
    .signature-name {
        font-size: 16px;
        font-weight: bold;
        width: 100%;
        text-align: center;
    }

    .manager-title {
      font-size: 16px;
    }

    .org-code {
        font-family: 'B Nazanin';
        font-size: 16px;
        font-weight: bold;
        color: #444;
    }

    .code-badge {
      border :  1px dashed #aaa !important;
      background-color: #00000011 !important;
      background: #00000011 !important;
      border-radius: 4px;
        color: black;
      padding: 3px 8px;
      font-size: 13px;
    }
 
      .signature-shape {
        border-radius:4px;
        border:1px dashed #aaa !important;;
        background-color: #00000008;
      }

   .breaker {
      border-top:1px dashed #555 !important;;
      margin:10px 0 5px 0;
   }
   body {
    display :flex;
    position:fixed;
    width:100%;
    height:100%;
    top:0;
    left:0;
   }
   .control {
    flex:1;
    display:flex;
    align-items:center;
    justify-content:center;
    height:100%;
   }
   .pages {
    height:100%;
    overflow-y:scroll;
   }
  </style>
  <style>


.control-part {
  width: 100%;
  max-width: 220px;
  background-color: #fafafa !important;
  border: 1px solid #ddd;
  border-radius: 12px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.07);
}

.control-title {
  font-size: 16px;
  text-align: center;
  margin: 0;
  color: #333 !important;
}

.control-card {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.control-card button {
  padding: 10px 16px;
  font-size: 15px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  font-family: inherit;
}

.print-btn {
  background-color: #28a745;
  color: white;
}

.print-btn:hover {
  background-color: #218838;
}

.back-btn {
  background-color: #dc3545;
  color: white;
}

.back-btn:hover {
  background-color: #c82333;
}
.letter-refrences {
    font-size: 14px;
}
.peivast {
  opacity: 0.8;
  padding: 0 10px;
}
  </style>
  {% block extra_head %}{% endblock %}
</head>

<body>
   <div class="pages">
          <div class="page default-page f-bnazanin">
              <div class="print-content">
                  <div>

                </div>
                <div class="content-box">
                    <div class="header">
                      <div class="sepah-logo f-bkoodak">
                          <img src="{% static 'img/Sepah.png' %}" alt="Ø¢Ø±Ù… Ø±Ø§Ø³Øª"/>
                          <br/>
                          <span  style="font-size: 10px; margin: 0 2px">Ù†ÛŒØ±ÙˆÛŒ Ø²Ù…ÛŒÙ†ÛŒ</span>
                      </div>
                      <div class="f-btitr">
                          <div class="f-irnasq text-center" style="font-size: 16px; ">Ø¨Ø³Ù…Ù‡ ØªØ¹Ø§Ù„ÛŒ</div>
                          <img src="{% static 'img/allah-placeholder.png' %}" alt="Ø¢Ø±Ù… ÙˆØ³Ø·">
                      </div>
                      <div class="left-info">
                        <div class="letter-detail">
                            <div style="display: flex;align-items: center;justify-content: space-between;gap: 4px;">
                                <strong class="f-btitr">Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ù…Ù‡ : </strong><span class="f-bkoodak" style="font-size: 10px">512/106/6/{{ letter.letter_number|lnumtrans }}Ø²</span><span></span>
                            </div>
                            <div style="display: flex;align-items: center;justify-content: space-between">
                              <strong class="f-btitr">ØªØ§Ø±ÛŒØ® : </strong> <span class="f-bkoodak"  style="font-size: 10px">{{ letter.date|to_jalali }}</span>
                            </div>
                            <div style="display: flex;align-items: center;justify-content: space-between">
                              <strong class="f-btitr">Ø§Ø±Ø¬Ø§Ø¹ : </strong> <span class="f-bkoodak"  style="font-size: 10px"></span>
                            </div>
                            <div style="display: flex;align-items: center;justify-content: space-between;gap: 4px;">
                                <strong class="f-btitr">Ù¾ÛŒÙˆØ³Øª : </strong><span class="f-bkoodak" style="font-size: 10px"></span><span></span>
                            </div>
                        </div>
                      </div>
                    </div>
                    <div>
                      <div class="slogan f-btitr">
                        Â«Ø§ÙØ²Ø§ÛŒØ´ ØªÙˆØ§Ù† Ø¯ÙØ§Ø¹ Ù‡Ù…Ù‡â€ŒØ¬Ø§Ù†Ø¨Ù‡ Ø¯Ø± Ø³Ø§Ù„ Ø¬Ù‡Ø´ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ Ù…Ø´Ø§Ø±Ú©Øª Ù…Ø±Ø¯Ù…Â»
                      </div>
                    </div>
                <div class="letter-refrences f-btitr" >
                    <strong> Ø¨Ù‡ : {{ letter.destination }}</strong>
                    <br>
                    <strong> Ø§Ø² :  Ø¢Ù…ÙˆØ²Ø´Ú¯Ø§Ù‡ Ø±Ø²Ù… Ù…Ù‚Ø¯Ù…Ø§ØªÛŒ Ø§Ù„Ù…Ù‡Ø¯ÛŒ (Ø¹Ø¬) Ù†ÛŒØ±ÙˆÛŒ Ø²Ù…ÛŒÙ†ÛŒ Ø³Ù¾Ø§Ù‡ - Ù…Ø¯ÛŒØ±ÛŒØª Ù†ÛŒØ±ÙˆÛŒ Ø§Ù†Ø³Ø§Ù†ÛŒ - Ù…Ù†Ø§Ø¨Ø¹ Ø§Ù†Ø³Ø§Ù†ÛŒ Ø³Ø±Ø¨Ø§Ø²</strong>
                </div>
                  <div class="f-btitr" style="font-size: 16px;font-weight:bold;margin-top:5px  ">
                    Ù…ÙˆØ¶ÙˆØ¹ : {{ letter.subject|default:letter.letter_type }}
                  </div>
                    <div  style="margin:5px 55px 0;font-size: 18px;font-style: italic;">
                        Ø³Ù„Ø§Ù… Ø¹Ù„ÛŒÚ©Ù…
                    </div>
              <div  class="content letter-content ">
                   <span class="salavat" style="font-weight: bolder">(( Ø§ÙÙ„Ù„Ù‘Ù‡ÙÙ…Ù‘ ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÛŒ Ù…ÙØ­ÙÙ…Ù‘ÙØ¯Ù ÙˆÙØ¢Ù„Ù Ù…ÙØ­ÙÙ…Ù‘ÙØ¯))</span>
                   <span class="respect">Ø¨Ø§ Ø§Ø­ØªØ±Ø§Ù…ØŒ</span>

                  {% block content %}

                  <!-- Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¯Ø± Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ ÙØ±Ø¹ÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                  {% endblock %}
              </div>
              <!-- Ø§Ù…Ø¶Ø§ Ùˆ Ù†Ø§Ù… Ù…Ø¯ÛŒØ± Ø«Ø§Ø¨Øª -->
              <div class="footer">
                  <div class="signature">
                        <div class="signature-name f-btitr">
                            <span class="manager-dagre" >{{ signature.degree|default:"Ø³Ø±Ù‡Ù†Ú¯ Ø¯ÙˆÙ… Ù¾Ø§Ø³Ø¯Ø§Ø±" }}</span>
                            <span style="margin: 0 5px;"></span>
                            <span class="manager-name">{{ signature.name|default:"Ø±Ø¶Ø§ Ø³Ø±ÙˆÛŒ" }}</span>
                        </div>
                        <div class="manager-title f-btitr">
                            {{ signature.duty|default:"Ù…Ø¯ÛŒØ± Ù†ÛŒØ±ÙˆÛŒ Ø§Ù†Ø³Ø§Ù†ÛŒ" }} Ø¢Ù…ÙˆØ²Ø´Ú¯Ø§Ù‡ Ø±Ø²Ù… Ù…Ù‚Ø¯Ù…Ø§ØªÛŒ Ø§Ù„Ù…Ù‡Ø¯ÛŒ (Ø¹Ø¬)
                            <br>
                            Ù†ÛŒØ±ÙˆÛŒ Ø²Ù…ÛŒÙ†ÛŒ Ø³Ù¾Ø§Ù‡
                        </div>
                  </div>
              </div>
          </div>
          <div class="peivast">
            <!-- Ú©Ø¯ Ø³Ø§Ø²Ù…Ø§Ù†ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ) -->
            {% if letter.soldier.organizational_code %}
                    <span class="org-code">{{ letter.soldier.organizational_code }}</span>
            {% endif %}
            {% if letter.soldier.clearance_expired_file_number %}
                    <span class="org-code">{{ letter.soldier.clearance_expired_file_number }}</span>
            {% endif %}
          </div>

        </div>
        </div>

      {% block pages %} {% endblock %}
   </div>


      <div class="control no-print">
        <div class="control-part ">
          <h3 class="control-title">ğŸ›  Ø¹Ù…Ù„ÛŒØ§Øª Ù¾Ø±ÛŒÙ†Øª</h3>
          <div class="control-card">
            <button class="print-btn" onclick="window.print()">ğŸ–¨ Ú†Ø§Ù¾ Ù†Ø§Ù…Ù‡</button>
            <a href="{% url 'soldier_edit' pk=letter.soldier.id %}"  class="btn btn-info" >ÙˆÛŒØ±Ø§ÛŒØ´ Ø³Ø±Ø¨Ø§Ø²</a>
            <button class="back-btn" onclick="history.back()">ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª</button>
          </div>
        </div>
      </div>

 </div>
  {% block extra_js %}{% endblock %}
</body>
</html>
