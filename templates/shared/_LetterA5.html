{% load render_partial %}
{% load static %}
{% load jalali_filters %}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Ù†Ø§Ù…Ù‡ Ø¯Ø§Ø®Ù„ÛŒ{% endblock %}</title>
    {% render_partial 'header_references_partial_view' %}
 
  <style>
    @media print {
      @page {
        size: A5 portrait;
        margin: 0;
      }
      html, body {
    margin: 0;
    padding: 0;
    height: auto;
    overflow: visible !important;
      }
      
      body {
        display: block !important;
        position: static !important;
      }
      * {
        visibility: hidden;
      }
    .pages .page {
      margin : 0;
    }
    .print-content {
      border: 0 none;
    }

       .pages *, 
       .pages .page,
       .pages .page * 
       {
        visibility: visible;
      }
      
      .pages {
        height: auto !important;
        overflow: visible !important;
        position: static !important;
      }
      .control,
      .no-print {
        display: none !important;
      }

    }
    


    .print-content {
      width: 148mm;
      height: 210mm;
      background: white;
      padding: 8mm;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      border : 1px solid #cacaca !important;
   }

    .pages .page {
      margin : 0 0 5px 0;
    }
     .content {
        font-size: 16px;
        line-height:1.8;
        text-align: justify;
        margin-top: 5px;
      }
      .flex-content {
         min-height:auto;
      }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #aaa !important;
      padding: 10px;
      border-radius: 5px;
      
    }

    .header img {
      height: 50px;
    }

    .left-info {
      font-size: 14px;
      text-align: right;
      flex:1;
    }
    .sepah-logo {
      flex:1;
      text-align:left;
    }
    .slogan {
      text-align: center;
      font-weight: bold;
      margin: 0 auto;
      font-size: 13px;
      background: #fafafa;
      border: 1px solid #aaa !important;
      padding: 5px;
      border-radius: 0 0 10px 10px;
      border-top:0 none;
      width:max-content;
    }

    .content-box {
      border: 1px solid #aaa !important;
      border-radius: 5px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      margin:5px 0;
    }

    .footer {
      margin-top: 25px;
    }

    .signature {
      text-align: center;
      margin-top: 20px;
    }

 .signature-box {
        height:80px;
        width:200px;
        border-radius:4px;
        margin:0 auto;
        border:1px dashed #aaa;
        background-color: #fafafa !important;; 
        margin:0 auto;

      }
    .signature-name {
      font-size: 16px;
      font-weight: bold;
      margin-top: 10px;
    }

    .manager-title {
      font-size: 13px;
    }

    .org-code {
      text-align: left;
      margin-top: 10px;
    }

    .code-badge {
      background-color: #00000008 !important;;
      border-radius: 4px;
      padding: 3px 8px;
      font-size: 13px;
    }
     .signature-name {
        margin: 10px 0;
      }
      .signature-shape {
                 border-radius:4px;
        border:1px dashed #aaa !important;;
        background-color: #00000008;
      }

   .breaker {
      border-top:2px dashed #555 !important;;
      margin:10px 0 5px 0;
   }
   body {
    display :flex;
    position:fixed;
    width:100%;
    height:100%;
    top:0;
    left:0;
   }
   .control {
    flex:1;
    display:flex;
    align-items:center;
    justify-content:center;
    height:100%;
   }
   .pages {
    height:100%;
    overflow-y:scroll;
   }
  </style>
  <style>


.control-part {
  width: 100%;
  max-width: 220px;
  background-color: #fafafa;
  border: 1px solid #ddd;
  border-radius: 12px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.07);
}

.control-title {
  font-size: 16px;
  text-align: center;
  margin: 0;
  color: #333;
}

.control-card {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.control-card button {
  padding: 10px 16px;
  font-size: 15px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  font-family: inherit;
}

.print-btn {
  background-color: #28a745;
  color: white;
}

.print-btn:hover {
  background-color: #218838;
}

.back-btn {
  background-color: #dc3545;
  color: white;
}

.back-btn:hover {
  background-color: #c82333;
}

  </style>
  {% block extra_head %}{% endblock %}
</head>

<body>
   <div class="pages">
          <div class="page default-page">
              <div class="print-content">
          <div>
              <div class="header">
                <div class="left-info">
                    <strong>ØªØ§Ø±ÛŒØ®:</strong> {{ letter.date|to_jalali }}<br>
                    <strong>Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ù…Ù‡:</strong> {{ letter.letter_number }}
                </div>
                <div>
                    <img src="{% static 'img/allah-placeholder.png' %}" alt="Ø¢Ø±Ù… ÙˆØ³Ø·">
                </div>
                <div class="sepah-logo">
                    <img src="{% static 'img/Sepah.png' %}" alt="Ø¢Ø±Ù… Ø±Ø§Ø³Øª">
                </div>
              </div>
          <div>
              <div class="slogan">
              Â«Ø§ÙØ²Ø§ÛŒØ´ ØªÙˆØ§Ù† Ø¯ÙØ§Ø¹ Ù‡Ù…Ù‡â€ŒØ¬Ø§Ù†Ø¨Ù‡ Ø¯Ø± Ø³Ø§Ù„ Ø¬Ù‡Ø´ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ Ù…Ø´Ø§Ø±Ú©Øª Ù…Ø±Ø¯Ù…Â»
          </div>
          </div>
          </div>
          <div class="content-box">
              <div>
                {{ letter.destination }}
                <br>
          <strong>Ø§Ø²:</strong> Ù‚Ø³Ù…Øª Ù†ÛŒØ±ÙˆÛŒ Ø§Ù†Ø³Ø§Ù†ÛŒ Ø¢Ù…ÙˆØ²Ø´Ú¯Ø§Ù‡ Ø±Ø²Ù… Ù…Ù‚Ø¯Ù…Ø§ØªÛŒ Ø§Ù„Ù…Ù‡Ø¯ÛŒ (Ø¹Ø¬) Ù†ÛŒØ±ÙˆÛŒ Ø²Ù…ÛŒÙ†ÛŒ Ø³Ù¾Ø§Ù‡
        </div>
              <div style="margin-top:10px; font-weight:bold;">
                Ù…ÙˆØ¶ÙˆØ¹: {{ letter.letter_type }}
              </div>
              
              <div  class="content">
                Ø¨Ø§ ØµÙ„ÙˆØ§Øª Ø¨Ø± Ù…Ø­Ù…Ù‘Ø¯ (Øµ) ÙˆØ¢Ù„ Ù…Ø­Ù…Ù‘Ø¯ (Øµ) Ùˆ Ø¨Ø§ Ø§Ø­ØªØ±Ø§Ù…ØŒ 
              {% block content %}
              <!-- Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¯Ø± Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ ÙØ±Ø¹ÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
              {% endblock %}
              </div>
              <!-- Ø§Ù…Ø¶Ø§ Ùˆ Ù†Ø§Ù… Ù…Ø¯ÛŒØ± Ø«Ø§Ø¨Øª -->
              <div class="footer">
              <div class="signature">
                <div class="signature-box signature-shape"></div>
                <div class="signature-name">
                    <span class="manager-dagre">{{ signature.degree|default:"Ø³Ø±Ù‡Ù†Ú¯ Ø¯ÙˆÙ… Ù¾Ø§Ø³Ø¯Ø§Ø±" }}</span>
                    <span style="margin:0 20px;"></span>
                    <span class="manager-name">{{ signature.name|default:"Ø±Ø¶Ø§ Ø³Ø±ÙˆÛŒ" }}</span>
                </div>
                <div class="manager-title">
                    {{ signature.duty|default:"Ù…Ø¯ÛŒØ± Ù†ÛŒØ±ÙˆÛŒ Ø§Ù†Ø³Ø§Ù†ÛŒ" }} Ø¢Ù…ÙˆØ²Ø´Ú¯Ø§Ù‡ Ø±Ø²Ù… Ù…Ù‚Ø¯Ù…Ø§ØªÛŒ Ø§Ù„Ù…Ù‡Ø¯ÛŒ (Ø¹Ø¬) Ù†ÛŒØ±ÙˆÛŒ Ø²Ù…ÛŒÙ†ÛŒ Ø³Ù¾Ø§Ù‡
                </div>
              </div>
              </div>
          </div>


          <!-- Ú©Ø¯ Ø³Ø§Ø²Ù…Ø§Ù†ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ) -->
          {% if letter.soldier.organizational_code %}
          <div class="org-code">
              <span class="code-badge">{{ letter.soldier.organizational_code }}</span>
          </div>
          {% endif %}
        </div>
        </div>

      {% block pages %} {% endblock %}
   </div>


      <div class="control no-print">
        <div class="control-part ">
          <h3 class="control-title">ğŸ›  Ø¹Ù…Ù„ÛŒØ§Øª Ù¾Ø±ÛŒÙ†Øª</h3>
          <div class="control-card">
            <button class="print-btn" onclick="window.print()">ğŸ–¨ Ú†Ø§Ù¾ Ù†Ø§Ù…Ù‡</button>
            <button class="back-btn" onclick="history.back()">ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª</button>
          </div>
        </div>
      </div>

 </div>
  {% block extra_js %}{% endblock %}
</body>
</html>
