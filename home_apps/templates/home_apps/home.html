{% extends 'shared/_PanelMain.html' %}

{% load static %}
{% load jalali_filters %}

{% block header %}
    {% include "./home_page_header.html" %}
{% endblock %}

{% block main %}
    <div>
        <div class="row ">
            <div class="col-md-12">
                <div class="shadow-card">
                    <div class="soldier-status">
                        <div class="soldier-item soldier-total">
                            <div class="item-content">
                                <span class="label">Ú©Ù„ Ø³Ø±Ø¨Ø§Ø²Ø§Ù†</span>
                                <span class="value">{{ stats.all_soldiers }} Ù†ÙØ±</span>
                            </div>
                            <a class="btn-download" href="{% url 'export_soldiers' %}?category=all" target="_blank">ğŸ“¥ Ø§Ú©Ø³Ù„</a>
                        </div>

                        <div class="soldier-item soldier-active">
                            <div class="item-content">
                                <span class="label">Ø­Ø§Ø¶Ø±</span>
                                <span class="value">{{ stats.active_soldiers }} Ù†ÙØ±</span>
                            </div>
                            <a class="btn-download" href="{% url 'export_soldiers' %}?category=active" target="_blank">ğŸ“¥ Ø§Ú©Ø³Ù„</a>
                        </div>

                        <div class="soldier-item soldier-forari">
                            <div class="item-content">
                                <span class="label">ÙØ±Ø§Ø±ÛŒ</span>
                                <span class="value">{{ stats.fugitives }} Ù†ÙØ±</span>
                            </div>
                            <a class="btn-download" href="{% url 'export_soldiers' %}?category=fugitives" target="_blank">ğŸ“¥ Ø§Ú©Ø³Ù„</a>
                        </div>
                                    <!-- 45 Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡ -->
                        <div class="soldier-item soldier-single alarm-blink">
                            <div class="item-content">
                                <span class="label">45 Ø±ÙˆØ² ØªØ§ Ù¾Ø§ÛŒØ§Ù† Ø®Ø¯Ù…Øª</span>
                                <span class="value">{{ stats.soldiers_45_to_end }} Ù†ÙØ±</span>
                            </div>
                            <a class="btn-download" href="{% url 'soldier_list' %}?remainingFilter=remaining45" target="_blank">Ù…Ø´Ø§Ù‡Ø¯Ù‡</a>
                        </div>
                            <div class="soldier-item soldier-financial-debt">
                                <div class="item-content">
                                    <span class="label">Ø¬Ø°Ø¨ÛŒ Ù‡Ø§ÛŒ Ø§Ù„Ù…Ù‡Ø¯ÛŒ</span>
                                    <span class="value">{{ stats.financial_debt }} Ù†ÙØ±</span>
                                </div>
                                <a class="btn-download" href="{% url 'export_soldiers' %}?category=financial_debt" target="_blank">
                                    ğŸ“¥ Ø§Ú©Ø³Ù„
                                </a>
                            </div>
                            <div class="soldier-item soldier-financial-debt">
                                <div class="item-content">
                                    <span class="label">Ù¾Ø°ÛŒØ±Ø´ Ø³Ø±Ø¨Ø§Ø²</span>
                                    <span class="value">{{ stats.jazbi }} Ù†ÙØ±</span>
                                </div>
                                <a class="btn-download" href="{% url 'export_soldiers' %}?category=jazbi" target="_blank">
                                    ğŸ“¥ Ø§Ú©Ø³Ù„
                                </a>
                            </div>

                    </div>

                </div>
            </div>
            <div   class="col-md-4">
                <div class="quick-access-box">
                    <h5 class="mb-3">ğŸ§­ Ø¯Ø³ØªØ±Ø³ÛŒ Ø³Ø±ÛŒØ¹ Ø¨Ù‡ Ù†Ø§Ù…Ù‡ Ù‡Ø§</h5>
                    <div class="letters-container">
                        {% if request.user.is_staff %}
                            <div class="letter-box">
                                <a class="letter-text" href="{% url 'ClearanceLetterListView' %}">ÙÙ‡Ø±Ø³Øª Ù†Ø§Ù…Ù‡ ØªØ³ÙˆÛŒÙ‡â€ŒØ­Ø³Ø§Ø¨ Ø§ØµÙ„ÛŒ</a>
                                <span class="letter-icon">ğŸ“©</span>
                            </div>
                            <div class="letter-box">
                                <a class="letter-text" href="{% url 'normal_letter_list' %}">ÙÙ‡Ø±Ø³Øª Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ø§Ø¯ÛŒ</a>
                                <span class="letter-icon">ğŸ§¾</span>
                            </div>
                            <div class="letter-box">
                                <a class="letter-text" href="{% url 'judicial_inquiry_list' %}">ÙÙ‡Ø±Ø³Øª Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù‚Ø¶Ø§ÛŒÛŒ</a>
                                <span class="letter-icon">âš–ï¸</span>
                            </div>

                            <div class="letter-box">
                                <a class="letter-text" href="{% url 'domestic_settlement_list' %}">ÙÙ‡Ø±Ø³Øª ØªØ³ÙˆÛŒÙ‡ Ø­Ø³Ø§Ø¨ Ø¯Ø§Ø®Ù„ÛŒ</a>
                                <span class="letter-icon">ğŸ›ï¸</span>
                            </div>
                            <div class="letter-box">
                                <a class="letter-text" href="{% url 'introduction_letter_list' %}">ÙÙ‡Ø±Ø³Øª Ù†Ø§Ù…Ù‡ Ù…Ø¹Ø±ÙÛŒ</a>
                                <span class="letter-icon">ğŸ‘¤</span>
                            </div>
                            <div class="letter-box">
                                <a class="letter-text" href="{% url 'membership_certificate_list' %}">ÙÙ‡Ø±Ø³Øª Ú¯ÙˆØ§Ù‡ÛŒ Ø¹Ø¶ÙˆÛŒØª</a>
                                    <span class="letter-icon">ğŸ“œ</span>
                            </div>
                            <div class="letter-box">
                                <a class="letter-text" href="{% url 'health_iodine_letter_list' %}">ÙÙ‡Ø±Ø³Øª ØªØ§ÛŒÛŒØ¯ÛŒÙ‡  Ø³Ù„Ø§Ù…Øª</a>
                                <span class="letter-icon">ğŸ¥</span>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        <div class="col-md-4 ">
            <div id="clearance-letter-tab" class="clearance-letter">
                <div style="display: flex;align-items: center;justify-content: space-between;margin-bottom: 10px;">
                    <h5 style="margin: 0;padding: 0;" class="mb-3">ØªØ³ÙˆÛŒÙ‡ Ø­Ø³Ø§Ø¨â€ŒÙ‡Ø§</h5>
                    <!-- Tabs -->
                    <div id="clearance-tabs" class="tabs" style="margin: 0;">
                        <span class="tab active" data-target="today-list">
                            Ø§Ù…Ø±ÙˆØ² ({{ clearance_letters.today|length }})
                        </span>
                        <span class="tab" data-target="week-list">
                            7 Ø±ÙˆØ² Ú¯Ø°Ø´ØªÙ‡ ({{ clearance_letters.last_week|length }})
                        </span>
                        <span class="tab" data-target="month-list">
                            30 Ø±ÙˆØ² Ú¯Ø°Ø´ØªÙ‡ ({{ clearance_letters.last_month|length }})
                        </span>
                    </div>
                </div>
                {% include 'components/clearance_letter_list.html' with letters=clearance_letters.today data_target="today-list" %}
                {% include 'components/clearance_letter_list.html' with letters=clearance_letters.last_week data_target="week-list" %}
                {% include 'components/clearance_letter_list.html' with letters=clearance_letters.last_month data_target="month-list" %}
            </div>
            <div class="clearance-letter">
                <div style="display: flex;align-items: center;justify-content: space-between;margin-bottom: 10px;">
                    <h5 style="margin: 0;padding: 0;" >ØªØ³ÙˆÛŒÙ‡ Ø­Ø³Ø§Ø¨ Ù‡Ø§ÛŒ ØªØ§ÛŒÛŒØ¯ Ù†Ø´Ø¯Ù‡</h5>
                    <div id="clearance-tabs" class="tabs" style="margin: 0;">
                        <span class="tab active" data-target="month-list">
                            Ø¯Ø±Ø­Ø§Ù„ ØªØ­ÙˆÛŒÙ„ ({{ clearance_letters.no_accepted|length }})
                        </span>
                    </div>
                </div>
                {% include 'components/clearance_letter_list.html' with letters=clearance_letters.no_accepted  %}
            </div>
        </div>

        </div>
    </div>

{% endblock %}

{% block footer %} 
<script>
    const tabs = document.querySelectorAll("#clearance-tabs .tab");

    const updateTabState=(activeTab)=>{
        panels = document.querySelectorAll("#clearance-letter-tab .letters")
        panels.forEach(list => {
            list.style.display = "none";
        });
        const target = activeTab.getAttribute("data-target");

        document.getElementById(target).style.display = "block";
    }

    tabs.forEach(tab => {
        tab.addEventListener("click", () => {
                tabs.forEach(t => t.classList.remove("active"));
                tab.classList.add("active");
                updateTabState(tab)
        });
    })

    const activeTab = document.querySelector("#clearance-tabs .tab.active");
    updateTabState(activeTab)

</script>

{% endblock %}
