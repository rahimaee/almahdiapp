{% extends "shared/_PanelMain.html" %}
{% load static %}

{% block header %}
    <link rel="stylesheet" href="{% static 'css/analystics_style.css' %}">
{% endblock %}

{% block main %}
<div class="container-fluid">
    {% include '../layout/AnalysticsNavbar.html' %}
    <div class="table-responsive mb-4">
        <table class="table table-bordered table-striped table-sm text-center">
            <thead class="thead-dark">
                <tr>
                    <th colspan="3" rowspan="2">نام قسمت</th>
                    <th colspan="6">تحصیلات</th>
                    <th colspan="4">وضعیت جسمانی و روانی</th>
                    <th rowspan="2">کمیسیون</th>
                    <th colspan="2">تاهل</th>
                    <th colspan="3">اداری / شیفتی / پستی</th>
                    <th colspan="2">بومی / غیر بومی</th>
                    <th colspan="5">مجموع و سقف</th>
                </tr>
                <tr>
                    <th class="rotate">زیر دیپلم</th>
                    <th class="rotate">دیپلم</th>
                    <th class="rotate">فوق دیپلم</th>
                    <th class="rotate">لیسانس</th>
                    <th class="rotate">فوق لیسانس</th>
                    <th class="rotate">دکتری</th>

                    <th class="rotate">سالم</th>
                    <th class="rotate">معاف از رزم</th>
                    <th class="rotate">گروه ب</th>
                    <th class="rotate">معاف+گروه ب</th>

                    <th class="rotate">مجرد</th>
                    <th class="rotate">متاهل</th>

                    <th class="rotate">اداری</th>
                    <th class="rotate">شیفتی</th>
                    <th class="rotate">پستی</th>

                    <th class="rotate">بومی</th>
                    <th class="rotate">غیر بومی</th>

                    <th class="rotate">مجموع</th>
                    <th class="rotate">سقف اصلی</th>
                    <th class="rotate">اختلاف</th>
                    <th class="rotate">سقف 70%</th>
                    <th class="rotate">اختلاف</th>
                </tr>
            </thead>
            <tbody>
                {% for r in reports %}
                <tr>
                    <td colspan="3">{{ r.unit.name }}</td>
                    <td>{{ r.edu.under_diploma }}</td>
                    <td>{{ r.edu.diploma }}</td>
                    <td>{{ r.edu.associate }}</td>
                    <td>{{ r.edu.bachelor }}</td>
                    <td>{{ r.edu.master }}</td>
                    <td>{{ r.edu.doctor }}</td>

                    <td>{{ r.health.healthy }}</td>
                    <td>{{ r.health.exempt_from_service }}</td>
                    <td>{{ r.health.group_b }}</td>
                    <td>{{ r.health.exempt_plus_group_b }}</td>

                    <td>{{ r.commission }}</td>

                    <td>{{ r.marital.single }}</td>
                    <td>{{ r.marital.married }}</td>

                    <td>{{ r.admin }}</td>
                    <td>{{ r.shift }}</td>
                    <td>{{ r.post }}</td>

                    <td>{{ r.native }}</td>
                    <td>{{ r.non_native }}</td>

                    <td>{{ r.total }}</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                {% endfor %}

                <!-- ردیف مجموع کل -->
                <tr class="table-primary total">
                    <td colspan="3"><b>مجموع</b></td>

                    <td>{{ totals.edu.under_diploma }}</td>
                    <td>{{ totals.edu.diploma }}</td>
                    <td>{{ totals.edu.associate }}</td>
                    <td>{{ totals.edu.bachelor }}</td>
                    <td>{{ totals.edu.master }}</td>
                    <td>{{ totals.edu.doctor }}</td>

                    <td>{{ totals.health.healthy }}</td>
                    <td>{{ totals.health.exempt_from_service }}</td>
                    <td>{{ totals.health.group_b }}</td>
                    <td>{{ totals.health.exempt_plus_group_b }}</td>

                    <td>{{ totals.commission }}</td>

                    <td>{{ totals.marital.single }}</td>
                    <td>{{ totals.marital.married }}</td>

                    <td>{{ totals.admin }}</td>
                    <td>{{ totals.shift }}</td>
                    <td>{{ totals.post }}</td>

                    <td>{{ totals.native }}</td>
                    <td>{{ totals.non_native }}</td>

                    <td>{{ totals.total }}</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                {% if request.user.is_staff %}
                    <tr class="table-primary natives">
                        <td colspan="3"><b>آمار اصلی</b></td>

                        <td>{{ natives.edu.under_diploma }}</td>
                        <td>{{ natives.edu.diploma }}</td>
                        <td>{{ natives.edu.associate }}</td>
                        <td>{{ natives.edu.bachelor }}</td>
                        <td>{{ natives.edu.master }}</td>
                        <td>{{ natives.edu.doctor }}</td>

                        <td>{{ natives.health.healthy }}</td>
                        <td>{{ natives.health.exempt_from_service }}</td>
                        <td>{{ natives.health.group_b }}</td>
                        <td>{{ natives.health.exempt_plus_group_b }}</td>

                        <td>{{ natives.commission }}</td>

                        <td>{{ natives.marital.single }}</td>
                        <td>{{ natives.marital.married }}</td>

                        <td>{{ natives.admin }}</td>
                        <td>{{ natives.shift }}</td>
                        <td>{{ natives.post }}</td>

                        <td>{{ natives.native }}</td>
                        <td>{{ natives.non_native }}</td>

                        <td>{{ natives.total }}</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                    </tr>
                    <tr class="table-primary difference">
                        <td colspan="3"><b>اختلاف اماری</b></td>

                        <td>{{ difference.edu.under_diploma }}</td>
                        <td>{{ difference.edu.diploma }}</td>
                        <td>{{ difference.edu.associate }}</td>
                        <td>{{ difference.edu.bachelor }}</td>
                        <td>{{ difference.edu.master }}</td>
                        <td>{{ difference.edu.doctor }}</td>

                        <td>{{ difference.health.healthy }}</td>
                        <td>{{ difference.health.exempt_from_service }}</td>
                        <td>{{ difference.health.group_b }}</td>
                        <td>{{ difference.health.exempt_plus_group_b }}</td>

                        <td>{{ difference.commission }}</td>

                        <td>{{ difference.marital.single }}</td>
                        <td>{{ difference.marital.married }}</td>

                        <td>{{ difference.admin }}</td>
                        <td>{{ difference.shift }}</td>
                        <td>{{ difference.post }}</td>

                        <td>{{ difference.native }}</td>
                        <td>{{ difference.non_native }}</td>

                        <td>{{ difference.total }}</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                    </tr>
                {% endif %}

            </tbody>
        </table>
    </div>
</div>
{% endblock %}
